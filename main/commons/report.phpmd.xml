<?xml version="1.0" encoding="UTF-8"?>


<project default="report.phpmd">


    <property name="report.phpmd:description" value="PHP Mess Detection"/>


    <target name="report.phpmd:help" depends="report.phpmd:init" hidden="true">
        <echo message="${report.phpmd:description}"/>
        <echo message=""/>
        <echo message="property                  value"/>
        <echo message="----------------------------------------------------------------------------------------------------"/>
        <echo message="report.phpmd.sources      ${report.phpmd.sources}"/>
        <echo message="report.phpmd.rulesets     ${report.phpmd.rulesets}"/>
        <echo message="report.phpmd.suffixes     ${report.phpmd.suffixes}"/>
        <echo message="report.phpmd.arguments    ${report.phpmd.arguments}"/>
        <echo message="report.phpmd.out          ${report.phpmd.out}"/>
        <echo message="report.phpmd.xsl          ${report.phpmd.xsl}"/>
        <echo message=""/>
        <echo message="property info"/>
        <echo message="----------------------------------------------------------------------------------------------------"/>
        <echo message="report.phpmd.sources      can be a comma separated string"/>
        <echo message="report.phpmd.rulesets     can be a comma separated string"/>
        <echo message="report.phpmd.suffixes     comma separated string of valid source code filename extensions"/>
        <echo message="report.phpmd.arguments    optional arguments that may be put after the mandatory arguments"/>
    </target>


    <target name="report.phpmd:init" hidden="true">
        <property name="report.phpmd.sources" value="${project.root}"/>
        <property name="report.phpmd.rulesets" value="cleancode,codesize,controversial,design,naming,unusedcode"/>
        <property name="report.phpmd.suffixes" value="php"/>
        <property name="report.phpmd.arguments" value=""/>
        <property name="report.phpmd.out" value="${project.build.reports}/phpmd"/>
        <property name="report.phpmd.xsl" value="${phing:commons:root}/resources/phpmd/phpmd.xsl"/>
    </target>


    <target name="report.phpmd:before" hidden="true">
        <echo message="no actions defined" level="debug"/>
    </target>


    <target name="report.phpmd:main" hidden="true">
        <delete dir="${report.phpmd.out}"/>
        <mkdir dir="${report.phpmd.out}"/>

        <exec executable="phpmd" logoutput="false" passthru="true" level="info" checkreturn="true">
            <arg line="${report.phpmd.sources}"/>
            <arg line="xml"/>
            <arg line="${report.phpmd.rulesets}"/>
            <arg line="--suffixes ${report.phpmd.suffixes}"/>
            <arg line="--reportfile ${report.phpmd.out}/phpmd.xml"/>
            <arg line="${report.phpmd.arguments}"/>
        </exec>

        <xslt file="${report.phpmd.out}/phpmd.xml" tofile="${report.phpmd.out}/index.html" style="${report.phpmd.xsl}"/>
    </target>


    <target name="report.phpmd:after" hidden="true">
        <echo message="no actions defined" level="debug"/>
    </target>


    <target name="report.phpmd" depends="report.phpmd:init, report.phpmd:before, report.phpmd:main, report.phpmd:after">
        <echo message="successful"/>
    </target>


</project>