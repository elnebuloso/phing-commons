<?xml version="1.0" encoding="UTF-8"?>


<project default="report.apigen">


    <target name="report.apigen:init" hidden="true">
        <property name="report.apigen.neon.use" value="no" />
        <property name="report.apigen.sources" value="src" />
        <property name="report.apigen.out" value="${project.reports}/apigen" />
    </target>


    <target name="report.apigen:before" hidden="true">
        <echo message="no actions defined" level="debug" />
    </target>


    <target name="report.apigen:main" hidden="true">
        <delete dir="${report.apigen.out}" />
        <mkdir dir="${report.apigen.out}" />

        <available file="${project.root}/apigen.neon" type="file" property="report.apigen.neon.exists" />

        <if>
            <and>
                <istrue value="${report.apigen.neon.use}" />
                <isset property="report.apigen.neon.exists" />
            </and>
            <then>
                <echo message="" />
                <echo message="forced usage of apigen.neon and apigen.neon exists" />
                <echo message="" />
                <property name="report.apigen.arguments" value="" />
            </then>
            <else>
                <echo message="" />
                <echo message="ignoring apigen.neon (does not exist or usage of apigen.neon is not forced)" />
                <echo message="" />
                <property name="report.apigen.arguments" value="${project.reports}/apigen ${report.apigen.sources}" />
            </else>
        </if>


        <exec executable="${phing:commons:root}/bin/apigen" logoutput="false" passthru="true" level="info" checkreturn="yes">
            <arg line="generate" />
            <arg line="${report.apigen.arguments}" />
        </exec>
    </target>


    <target name="report.apigen:after" hidden="true">
        <echo message="no actions defined" level="debug" />
    </target>


    <target name="report.apigen" depends="report.apigen:init, report.apigen:before, report.apigen:main, report.apigen:after">
        <echo message="successful" />
    </target>


    <target name="report.apigen:help" depends="report.apigen:init" hidden="true">
        <echo message="Property                  Value" />
        <echo message="----------------------------------------------------------------------------------------------------" />
        <echo message="report.apigen.neon.use    yes|no: ${report.apigen.neon.use}" />
        <echo message="report.apigen.sources     ${report.apigen.sources}" />
        <echo message="report.apigen.out         ${report.apigen.out}" />
    </target>


</project>