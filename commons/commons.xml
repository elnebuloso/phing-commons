<?xml version="1.0" encoding="UTF-8"?>


<project name="commons" default="help">


    <!-- ============================================ -->
    <!-- phing commons setup                          -->
    <!-- ============================================ -->
    <property name="phing:commons:root" value="${phing.home}/../../.." override="true" />

    <resolvepath propertyName="phing:commons:root" file="${phing:commons:root}" />
    <resolvepath propertyName="phing:commons:commons" file="${phing:commons:root}/commons" />


    <!-- ============================================ -->
    <!-- phing commons properties                     -->
    <!-- ============================================ -->
    <loadfile property="phing:commons:version" file="${phing:commons:root}/VERSION" />

    <php function="trim" returnProperty="phing:commons:version" level="debug">
        <param value="${phing:commons:version}" />
    </php>


    <!-- ============================================ -->
    <!-- project properties                           -->
    <!-- ============================================ -->
    <php function="dirname" returnProperty="project.root" level="debug">
        <param value="${phing.file}" />
    </php>

    <resolvepath propertyName="project.root" file="${project.root}" />

    <property file="${project.root}/build.properties" />
    <property file="${project.root}/build.properties.local" />

    <loadfile property="project.version" file="${project.root}/VERSION" />

    <php function="trim" returnProperty="project.version" level="debug">
        <param value="${project.version}" />
    </php>

    <fail unless="project.vendor" message="missing project.vendor" />
    <fail unless="project.name" message="missing project.name" />
    <fail unless="project.version" message="missing project.version" />

    <property name="project.tmp" value="${project.root}/build/tmp" />
    <property name="project.reports" value="${project.root}/build/reports" />

    <resolvepath propertyName="project.tmp" file="${project.tmp}" />
    <resolvepath propertyName="project.reports" file="${project.reports}" />


    <!-- ============================================ -->
    <!-- commons tasks                                -->
    <!-- ============================================ -->
    <taskdef classname="Commons_Phing_Task_Project_UpdateVersion" name="commons-project-update-version" />


    <!-- ============================================ -->
    <!-- phing commons targets                        -->
    <!-- ============================================ -->
    <import file="${phing:commons:commons}/targets/clean.xml" />
    <import file="${phing:commons:commons}/targets/project.xml" />
    <import file="${phing:commons:commons}/targets/report.xml" />
    <import file="${phing:commons:commons}/targets/test.xml" />


    <!-- ============================================ -->
    <!-- help.commons                                 -->
    <!-- ============================================ -->
    <target name="help.commons" hidden="true">
        <echo message="PROPERTY                                          VALUE" />
        <echo message="----------------------------------------------------------------------------------------------------" />
        <echo message="phing:commons:version                             ${phing:commons:version}" />
        <echo message="phing:commons:commons                             ${phing:commons:commons}" />
        <echo message="phing:commons:root                                ${phing:commons:root}" />
    </target>


    <!-- ============================================ -->
    <!-- help.project                                 -->
    <!-- ============================================ -->
    <target name="help.project" hidden="true">
        <echo message="PROPERTY                                          VALUE" />
        <echo message="----------------------------------------------------------------------------------------------------" />
        <echo message="project.version                                   ${project.version}" />
        <echo message="project.vendor                                    ${project.vendor}" />
        <echo message="project.name                                      ${project.name}" />
        <echo message="project.root                                      ${project.root}" />
        <echo message="project.tmp                                       ${project.tmp}" />
        <echo message="project.reports                                   ${project.reports}" />
    </target>


    <target name="help" depends="help.commons, help.project" hidden="true" />


    <!-- ============================================ -->
    <!-- setup the chains                             -->
    <!-- ============================================ -->
    <import file="${phing:commons:commons}/chains/default.xml" />
    <import file="${phing:commons:commons}/chains/hooks/default.xml" />


    <target name="clean" depends="chain.clean:before, chain.clean:main, chain.clean:after">
        <echo message="successful" />
    </target>


    <target name="init" depends="chain.init:before, chain.init:main, chain.init:after">
        <echo message="successful" />
    </target>


    <target name="test" depends="chain.test:before, chain.test:main, chain.test:after">
        <echo message="successful" />
    </target>


    <target name="bundle" depends="chain.bundle:before, chain.bundle:main, chain.bundle:after">
        <echo message="successful" />
    </target>


    <target name="package" depends="chain.package:before, chain.package:main, chain.package:after">
        <echo message="successful" />
    </target>


    <target name="deploy" depends="chain.deploy:before, chain.deploy:main, chain.deploy:after">
        <echo message="successful" />
    </target>


    <target name="build" depends="chain.build:before, chain.build:main, chain.build:after">
        <echo message="successful" />
    </target>


    <target name="report" depends="chain.report:before, chain.report:main, chain.report:after">
        <echo message="successful" />
    </target>


</project>